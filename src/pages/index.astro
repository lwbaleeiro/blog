---
import Layout from '../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const posts = await getCollection('blog');
posts.sort((a, b) => new Date(b.data.date).valueOf() - new Date(a.data.date).valueOf());
---
<Layout title="blog" activeNav="blog">
  <section id="blog" class="active" style="display:block;">
    <div class="sec-head">
      <h2>/blog</h2>
      <span class="bc">~/blog $ ls -lt --color</span>
    </div>

    <div class="plw" id="plw">
      <div class="post-list">
        {posts.map((post) => {
          const base = import.meta.env.BASE_URL.replace(/\/$/, '') || '';
          return (
            <a href={`${base}/blog/${post.slug}`} style="text-decoration:none; color:inherit; display:block; margin-bottom:1px;">
              <div class="post-item">
                <div class="pm">
                  <span>{post.data.date}</span>
                  {post.data.tags.map((tag) => (
                    <span class={`pt ${tag}`}>{tag}</span>
                  ))}
                </div>
                <div class="ptitle">{post.data.title}</div>
                <div class="pexc">{post.data.description}</div>
                <div class="pfoot">$ cat <span class="r">â†’ read post</span></div>
              </div>
            </a>
          );
        })}
      </div>
    </div>
  </section>
</Layout>
